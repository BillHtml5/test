<!DOCTYPE html>
<html lang="zh-Hans">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        #canvas {
            background: ghostwhite;
            display: block;

        }

        button {
            position: fixed;
            bottom: 0;
            left: 0;
        }
        .actions{
            position: fixed;
            bottom: 0;
            left: 0;
        }
        .actions > #brush{
            display: none;
        }
        .actions.x > #brush{
            display: inline-block;
        }
        .actions.x > #eraser{
            display: none;
        }


    </style>
</head>

<body>
    <canvas id="canvas" width=300 height=300></canvas>
    <div id="actions" class="actions">
        <button id="eraser">橡皮擦</button>
        <button id="brush">画笔</button>
    </div>
    <script>
        var yyy = document.getElementById('canvas');
        var context = yyy.getContext('2d');
        setCanvas(yyy)
        listenMouse(yyy)

        var usingEraser = false
        eraser.onclick = function () {
            usingEraser=true
            actions.className='actions x'
        }
        brush.onclick = function () {
            usingEraser = false
            actions.className='actions'
        }


        //----------------------------------------------
        function setCanvas() {
            prt()
            window.onresize = function () {
                prt()
            }
            function prt() {
                var pageWidth = document.documentElement.clientWidth
                var pageHeight = document.documentElement.clientHeight

                yyy.width = pageWidth
                yyy.height = pageHeight
            }
        }

        function listenMouse(yyy) {
            var painting = false
            var lastPoint = { x: undefined, y: undefined }
            yyy.onmousedown = function (aaa) {

                var x = aaa.clientX
                var y = aaa.clientY
                painting = true
                if (usingEraser) {
                    context.clearRect(x - 5, y - 5, 10, 10)
                } else {                  
                    var lastPoint = { "x": x, "y": y }
                }
            }

            yyy.onmousemove = function (aaa) {
                var x = aaa.clientX
                var y = aaa.clientY
                if(!painting){return}
                if (usingEraser) {                  
                    context.clearRect(x - 5, y - 5, 10, 10)
                } else {
                    var newPoint = { "x": x, "y": y }
                }
                drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y)
                lastPoint = newPoint
            }

            yyy.onmouseup = function (aaa) {
                painting = false
            }

            function drawLine(x1, y1, x2, y2) {
                context.beginPath();
                context.strokeStyle = 'black'
                context.moveTo(x1, y1)
                context.lineWidth = 5
                context.lineTo(x2, y2)
                context.stroke()
                context.closePath()
            }

            function drawCircle(x, y, redius) {
                context.beginPath()
                context.fillStyle = 'black'
                context.arc(x, y, redius, 0, Math.PI * 2);
                context.fill()
            }
        }
    </script>
</body>

</html>